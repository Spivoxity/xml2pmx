# Makefile

## Config stuff:
FIXUP = @FIXUP@
## End of config

all: runtime

runtime: force
	$(MAKE) -C runtime all

TEST := $(patsubst %,test-%,$(notdir $(wildcard test/*.xml)))

test: $(TEST)

test-%.xml: force
	runtime/xml2pmx test/$*.xml $*.pmx a 0
	$(FIXUP) < $*.pmx | cmp test/$*.exp - && echo "**PASSED**"
	@rm -r $*.pmxprep $*.pmx

clean realclean: %: %here
	$(MAKE) -C runtime $@

cleanhere: force

realcleanhere: cleanhere
	rm -f configure config.status config.log platform.h

force:
